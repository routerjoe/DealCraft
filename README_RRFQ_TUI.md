# Red River MCP — TUI Bundle (RFQ→Award)
Created: Friday, October 17 2025 EDT
Updated: Friday, October 24 2025 EDT

## Contents
- Dashboard with Top 10 GO RFQs, live funnel stats, provider health
- RFQ Management: Get → Process → Analyze workflow with streaming progress
- RFQ Details modal: edit attributes, re-run rules/scoring, open guidance editor
- Guidance editor: manage OEM authorizations and supported contract vehicles
- AI-powered analysis: Claude/ChatGPT-5/Gemini integration for GO/NO-GO recommendations
- Email generation: SMTP notifications with optional AI-generated guidance sections
- Cleanup workflow: delete NO-GO RFQs with optional Outlook email removal

## Run
```bash
bash tui/scripts/rrtui.sh
```

## Key Features

### Workflow Actions (RFQ Management Screen)
- **g** = Get Emails (metadata only, no attachment downloads)
- **p** = Process (downloads attachments, parses CSVs, records to DB)
- **a** = Analyze (runs rules + optional AI analysis for scoring)
- **r** = Full Workflow (Get → Process → Analyze in sequence)
- **d** = Download Attachments (on selected RFQ only)

### RFQ Details & Guidance
- **Enter/o** = Open Details modal for selected RFQ
- **e** = Edit Guidance (OEM authorizations + contract vehicles)
  - Add/toggle OEMs and contracts
  - Changes persist to SQLite config tables
  - Re-run analysis to see updated scores

### AI Email Guidance
When `RFQ_EMAIL_AI_GUIDANCE=true` in `.env`:
- SMTP-sent RFQ notification emails include dynamic "Next Steps" generated by AI
- Uses prompt from [`docs/rfq/rfq_guidance_kilocode_prompt.md`](docs/rfq/rfq_guidance_kilocode_prompt.md)
- Provider selected via `RFQ_AI_DEFAULT_PROVIDER` (claude/openai/gemini)
- Falls back to static template on error

### Environment Variables
See [`.env.example`](.env.example) for all configuration options including:
- SMTP credentials for email notifications
- AI provider API keys (ANTHROPIC_API_KEY, OPENAI_API_KEY, GOOGLE_API_KEY)
- `RFQ_AI_ENABLED` and `RFQ_EMAIL_AI_GUIDANCE` flags
- Path overrides for storage locations

## Architecture
- **Backend:** TypeScript MCP tools via [`mcp/bridge.mjs`](mcp/bridge.mjs) + [`mcp/cli.py`](mcp/cli.py)
- **TUI:** Python Textual framework in `tui/rrtui/`
- **Database:** SQLite with sql.js (Node) and sqlite3 (Python fallback)
- **Email:** SMTP via nodemailer + optional AI-generated content
- **AppleScript:** Outlook integration for reading/downloading/deleting emails

## Notes
- Attachments downloaded during Process step, stored in `ATTACHMENTS_DIR/<email_id>/`
- Cleanup respects NO-GO decision; optional Outlook email deletion performed first
- AI analysis combines rule-based scoring with strategic insights
