# Release v1.4.0 — Phase 4: Forecast & Govly Automation Batch

Release Date: Tuesday, October 28 2025 EDT  
Tag: v1.4.0  
Type: Feature Release (APIs + TUI + Obsidian)

## Summary
Phase 4 delivers production-ready forecasting, Govly/Radar ingestion, metrics/latency monitoring, Obsidian dashboards, and TUI integration. All features ship with full tests, atomic persistence, and backward-compatible YAML/notes.

## Delivered Components

### 1) Forecast Hub Engine
- POST /v1/forecast/run — generate multi-year forecasts for FY25, FY26, FY27
- GET /v1/forecast/summary — aggregate analytics with confidence tiers
- Forecast fields: `projected_amount_FY25`, `projected_amount_FY26`, `projected_amount_FY27`, `confidence_score (0–100)`
- Persistence: `data/forecast.json` (atomic writes)
- Derived fields appended to related opportunities in `state.json`

### 2) Radar Parser & Govly Webhook Ingestion
- POST /v1/govly/webhook — ingest federal opportunity events from Govly
- POST /v1/radar/webhook — ingest contract modifications from Radar
- Append-only persistence to `state.json → opportunities[]`
- Auto-generates minimal `opportunity.md` files in `obsidian/40 Projects/Opportunities/Triage/`
- Sets `triage: true` for manual review
- Request ID + latency headers for traceability

### 3) Metrics + Latency Monitor
- GET /v1/metrics — returns `avg_latency_ms`, `p95_latency_ms`, `p99_latency_ms`, `request_volume_last_7d`, `request_volume_total`, `accuracy_confusion`, and per-endpoint stats
- POST /v1/metrics/accuracy — record accuracy outcomes
- GET /v1/metrics/health — health check
- Persistence: `data/metrics.json` (up to 1000 requests)

### 4) Obsidian Enhancements
- Opportunity template updated with forecast frontmatter and triage banner
- Opportunities Dashboard — triage queue, high-confidence (≥75%), grouping by customer/OEM/close date
- Forecast Dashboard — FY25/26/27 projections, confidence distribution, customer breakdowns

### 5) TUI Integration
- New MetricsPanel: real-time latency, request volumes, accuracy matrix, Top-5 slowest endpoints
- Shortcuts: `M` (refresh), `P` (toggle auto-refresh)
- Integrated into main TUI with distinct border styling

## Quality & Performance
- Tests: 101/101 passing (18 new tests)
- Lint/Format: ruff clean
- Build: kc run:build passed
- Avg latency: ~45 ms for forecasts (target ≤250 ms)
- Branch coverage: ≥90%
- No secrets committed; uses `.env`
- Backward compatible (no breaking YAML changes)

## Key Technical Notes
- Atomic file writes to prevent corruption
- Timezone-safe (UTC)
- Heuristic forecasting (pluggable path for model-driven predictions)
- Confidence tiers: High (75–100), Medium (50–74), Low (0–49)
- Append-only audit trail for opportunities
- Proper HTTP error handling + status codes

## Upgrade Notes
1. Deploy code for v1.4.0.
2. Ensure write permissions for `data/forecast.json`, `data/metrics.json`, and `state.json`.
3. Expose webhook routes externally (Govly, Radar) and configure secrets in `.env`.
4. Open Obsidian vault and verify both dashboards render and Dataview queries complete without errors.

## API Smoke Tests (curl)
```bash
curl -s -X POST http://localhost:8000/v1/forecast/run | jq
curl -s http://localhost:8000/v1/forecast/summary | jq
curl -s -X POST http://localhost:8000/v1/govly/webhook \
  -H 'Content-Type: application/json' \
  -d '{"id":"demo-1","title":"Sample RFQ","customer":"AFCENT","close_date":"2025-11-15","vehicle":"SEWP"}' | jq
curl -s -X POST http://localhost:8000/v1/radar/webhook \
  -H 'Content-Type: application/json' \
  -d '{"id":"rad-42","action":"mod","notes":"CLIN updated"}' | jq
curl -s http://localhost:8000/v1/metrics | jq
curl -s http://localhost:8000/v1/metrics/health | jq